close all;
clear all;
clc;
Potencia_dBm1 = [-27.650 -28.150 -28.650 -29.150 -29.650 -30.150 -30.650 -31.150 -31.650 -32.150 -32.650 -33.150 -33.650 -34.150 -34.650 -35.150 -35.650 -36.150 -36.650 -37.150];
EVM1 = [6.662 7.071 7.652 8.413 9.141 10.475 11.243 12.742 14.084 15.680 17.821 20.969 22.648 25.980 28.821 32.295 36.666 42.315 49.726 59.050];
potencia1 = [-19.258 -20.258 -21.258 -22.258 -23.258 -24.258 -25.258 -26.258 -27.258 -28.258 -29.258 -30.258 -31.258 -32.258 -33.258];
evm2 = [1.56, 2.567, 2.987, 3.543, 4.123, 5.678, 7.456, 12.345, 18.234, 32.567, 48.234, 65.432, 78.654, 89.543, 95.678];
prx1 = [-19.258 -20.258 -21.258 -22.258 -23.258 -24.258 -25.258 -26.258 -27.258 -28.258 -29.258 -30.258 -31.258 -32.258 -33.258];
evm3 = [3.826 4.321 4.824 6.212 8.189 11.339 16.462 26.379 46.230 83.746 93.596 96.659 98.547 99.456 99.989];
potencia2 = [-19.258, -20.258, -21.258, -22.258, -23.258, -24.258, -25.258, -26.258, -27.258, -28.258, -29.258, -30.258, -31.258, -32.258, -33.258];
evm4 = [2.015, 2.300, 2.650, 3.134, 4.000, 5.953, 9.052, 16.062, 34.920, 61.335, 80.231, 89.543, 93.541, 95.774, 97.229];

figure;
semilogy(Potencia_dBm1, EVM1, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'b')
hold on;
semilogy(potencia1, evm2, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'r')
hold on;
semilogy(prx1, evm3, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'g')
hold on;
semilogy(potencia2, evm4, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'm')
hold on;
xlabel('Potencia de recepción [dBm]')
ylabel('EVM [%]')
title('Potencia VS EVM');
grid on
legend('4-QAM', '16-QAM','64-QAM','256-QAM');