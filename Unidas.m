close all;
clear all;
clc;
Potencia_dBm1 = [-27.650 -28.150 -28.650 -29.150 -29.650 -30.150 -30.650 -31.150 -31.650 -32.150 -32.650 -33.150 -33.650 -34.150 -34.650 -35.150 -35.650 -36.150 -36.650 -37.150];
BER1 = [0 0 0 0 4.5e-6 1.3e-5 1.8e-5 4.5e-5 7.2e-5 1.26e-4 3.15e-4 6.30e-4 1.17e-3 2.04e-3 2.25e-3 2.88e-3 3.15e-3 3.60e-3 4.05e-3 4.50e-3];
potencia1 = [-19.258 -20.258 -21.258 -22.258 -23.258 -24.258 -25.258 -26.258 -27.258 -28.258 -29.258 -30.258 -31.258 -32.258 -33.258];
ber2 =  [2.00E-05 3.00E-05 5.00E-05 1.20E-04 3.50E-04 1.10E-03 4.50E-03 1.35E-02 3.30E-02 5.80E-02 7.10E-02 7.80E-02 8.00E-02 8.10E-02 8.20E-02];

prx1 = [-19.258 -20.258 -21.258 -22.258 -23.258 -24.258 -25.258 -26.258 -27.258 -28.258 -29.258 -30.258 -31.258 -32.258 -33.258];
ber3 = [1.00E-05 1.50E-05 2.50E-05 6.00E-05 1.75E-04 5.50E-04 2.25E-03 6.75E-03 1.65E-02 2.90E-02 3.55E-02 3.90E-02 4.00E-02 4.05E-02 4.10E-02];

potencia2 = [-19.258, -20.258, -21.258, -22.258, -23.258, -24.258, -25.258, -26.258, -27.258, -28.258, -29.258, -30.258, -31.258, -32.258, -33.258];
ber4 = [5.00E-07, 8.00E-07, 1.50E-06, 3.00E-06, 9.00E-06, 3.20E-05, 1.15E-04, 3.45E-04, 8.50E-04, 1.60E-03, 2.20E-03, 2.70E-03, 2.90E-03, 3.00E-03, 3.10E-03];
figure;
semilogy(Potencia_dBm1, BER1, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'b')
hold on;
semilogy(potencia1, ber2, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'r')
hold on;
semilogy(prx1, ber3, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'g')
hold on;
semilogy(potencia2, ber4, 'o-', 'LineWidth', 2, 'MarkerFaceColor', 'm')
hold on;
xlabel('Potencia de recepción [dBm]')
ylabel('BER')
title('Potencia VS BER');
grid on
legend('4-QAM', '16-QAM','64-QAM','256-QAM');